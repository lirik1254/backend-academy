@startuml
actor User
participant "UI (XML)" as UI
participant "Mobile App\n(Java + Android SDK)" as MobileApp
participant "Серверная часть\n(Java + Spring)" as Server
database PostgreSQL as PostgreSQL
database "Yandex Cloud Storage" as CloudStorage

User -> UI: Нажимает вкладку «Специалисты»
activate UI
UI -> MobileApp: Запрос списка специалистов
activate MobileApp

MobileApp -> Server: Запрос текстовых данных
activate Server
Server -> PostgreSQL: Получить данные пользователей
activate PostgreSQL

alt Данные получены успешно
    PostgreSQL --> Server: Данные пользователей
    deactivate PostgreSQL

    Server --> MobileApp: Текстовые данные
    deactivate Server

    MobileApp -> CloudStorage: Запрос аватарок
    activate CloudStorage

    alt Аватарки доступны
        CloudStorage --> MobileApp: Изображения
        deactivate CloudStorage
        MobileApp -> UI: Отобразить карточки с аватарками
    else Нет аватарок или ошибка
        CloudStorage --> MobileApp: Ошибка/нет данных
        deactivate CloudStorage
        MobileApp -> UI: Отобразить карточки без аватарок
    end

else Ошибка получения данных
    PostgreSQL --> Server: Ошибка
    deactivate PostgreSQL
    Server --> MobileApp: Ошибка
    deactivate Server
    MobileApp -> UI: Показать «Не удалось загрузить»
end

... Запрос конкретного профиля ...

User -> UI: Нажимает на карточку специалиста
activate UI
UI -> MobileApp: Запрос профиля специалиста
activate MobileApp

MobileApp -> Server: Запрос данных профиля
activate Server
Server -> PostgreSQL: Получить данные профиля
activate PostgreSQL

alt Данные получены
    PostgreSQL --> Server: Данные профиля
    deactivate PostgreSQL

    Server --> MobileApp: Текстовые данные
    deactivate Server

    MobileApp -> CloudStorage: Запрос медиа-контента
    activate CloudStorage

    alt Контент доступен
        CloudStorage --> MobileApp: Медиа-данные
        deactivate CloudStorage
        MobileApp -> UI: Отобразить полный профиль
    else Ошибка загрузки
        CloudStorage --> MobileApp: Ошибка
        deactivate CloudStorage
        MobileApp -> UI: Показать «Ошибка загрузки»
    end

else Ошибка получения данных
    PostgreSQL --> Server: Ошибка
    deactivate PostgreSQL
    Server --> MobileApp: Ошибка
    deactivate Server
    MobileApp -> UI: Показать «Ошибка загрузки»
end

deactivate MobileApp
deactivate UI
@enduml
